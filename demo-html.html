<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>WP2 Update - UI Demo & Simulator</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
	<style>
		/* Custom Styles inspired by the WordPress Admin UI & your SCSS */
		:root {
			--wp2-color-primary: #2271b1;
			--wp2-color-primary-dark: #1d5f96;
			--wp2-color-success: #00a32a;
			--wp2-color-warning: #dba617;
			--wp2-color-error: #d63638;
			--wp2-color-border: #ccd0d4;
			--wp2-color-bg-card: #ffffff;
			--wp2-color-bg-alt: #f6f7f7;
			--wp2-color-bg-info: #eef4ff;
			--wp2-color-bg-updating: #fefce8;
			--wp2-color-text: #1d2327;
			--wp2-color-text-subtle: #50575e;
			--wp2-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
		}

		body {
			background-color: #f0f0f1;
			font-family: var(--wp2-font-family);
		}

		.wp2-container {
			max-width: 1200px;
			margin: 2rem auto;
			padding: 1rem 2rem;
		}

		.wp2-header {
			padding-bottom: 1rem;
			border-bottom: 1px solid var(--wp2-color-border);
			margin-bottom: 1.5rem;
		}

		.wp2-header h1 {
			font-size: 23px;
			font-weight: 600;
		}

		.wp2-header p {
			font-size: 14px;
			color: var(--wp2-color-text-subtle);
		}

		.nav-tabs .nav-link {
			color: var(--wp2-color-text-subtle);
			font-weight: 600;
			border-bottom-width: 4px;
			border-color: transparent;
		}

		.nav-tabs .nav-link.active {
			color: var(--wp2-color-primary);
			border-color: var(--wp2-color-primary);
			background-color: transparent;
		}

		.card {
			border: 1px solid var(--wp2-color-border);
			border-radius: 4px;
			box-shadow: 0 1px 1px rgba(0,0,0,.04);
		}

		.table {
			margin-top: 1rem;
		}

		.table th {
			font-weight: 600;
			color: #2c3338;
		}

		.table td {
			vertical-align: middle;
		}

		.badge.bg-success-light {
			background-color: #e6f7e9;
			color: #006428;
		}

		.badge.bg-warning-light {
			background-color: #fff8e5;
			color: #744d00;
		}

		.badge.bg-secondary-light {
			background-color: #f0f0f1;
			color: var(--wp2-color-text-subtle);
		}

		.updating-row {
			background-color: var(--wp2-color-bg-updating) !important;
			opacity: 0.7;
		}

		.health-card .bi {
			font-size: 1.2rem;
		}

		.health-card .pass { color: #28a745; }
		.health-card .warn { color: #ffc107; }
		.health-card .fail { color: #dc3545; }

		.log-viewer {
			background-color: #1e1e1e;
			color: #d4d4d4;
			font-family: 'Menlo', 'Consolas', monospace;
			height: 300px;
			overflow-y: scroll;
			padding: 1rem;
			border-radius: 4px;
			font-size: 13px;
			border: 1px solid #333;
		}
		.log-entry {
			white-space: pre-wrap;
			padding: 2px 0;
		}
		.log-entry .timestamp { color: #999; }
		.log-entry .level-INFO { color: #6a9955; }
		.log-entry .level-DEBUG { color: #569cd6; }
		.log-entry .level-WARNING { color: #ce9178; }
		.log-entry .level-ERROR { color: #f44747; }
		.log-entry .level-SECURITY { color: #c586c0; }

		.toast-container {
			z-index: 1100;
		}

		.wizard-step { display: none; }
		.wizard-step.active { display: block; }
	</style>
</head>
<body>
	<div class="wp2-container">
		<!-- Header -->
		<div class="wp2-header d-flex flex-wrap justify-content-between align-items-start">
			<div>
				<h1><i class="bi bi-cloud-arrow-up-fill me-2"></i>WP2 Update</h1>
				<p>Manage your GitHub-hosted plugins and themes with clarity, confidence, and control.</p>
			</div>
			<div class="d-flex gap-2 mt-2 mt-md-0">
				<button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createPackageModal">
					<i class="bi bi-plus-lg me-1"></i> Create Package
				</button>
				<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAppModal">
					<i class="bi bi-github me-1"></i> Add GitHub App
				</button>
				<button id="sync-all-btn" class="btn btn-outline-secondary">
					<i class="bi bi-arrow-repeat me-1"></i> Sync All
				</button>
			</div>
		</div>
		<!-- Tabs -->
		<ul class="nav nav-tabs" id="main-tabs" role="tablist">
			<li class="nav-item" role="presentation">
				<button class="nav-link active" id="packages-tab" data-bs-toggle="tab" data-bs-target="#packages-panel" type="button" role="tab">Packages</button>
			</li>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="apps-tab" data-bs-toggle="tab" data-bs-target="#apps-panel" type="button" role="tab">Apps</button>
			</li>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="health-tab" data-bs-toggle="tab" data-bs-target="#health-panel" type="button" role="tab">Health</button>
			</li>
		</ul>
		<!-- Tab Content -->
		<div class="tab-content" id="myTabContent">
			<!-- Packages Panel -->
			<div class="tab-pane fade show active" id="packages-panel" role="tabpanel">
				<div class="card mt-4">
					<div class="card-body">
						<table class="table table-hover">
							<thead>
								<tr>
									<th>Package</th>
									<th>Installed Version</th>
									<th>Status</th>
									<th>Release Channel</th>
									<th class="text-end">Actions</th>
								</tr>
							</thead>
							<tbody>
								<tr id="package-row-1">
									<td>
										<strong>OTW Theme</strong>
										<div class="text-muted small">On-The-Water-Media/otw-theme</div>
									</td>
									<td>1.0.2</td>
									<td>
										<span class="badge bg-warning-light rounded-pill">
											<i class="bi bi-arrow-up-circle-fill me-1"></i>Update available (1.1.0)
										</span>
									</td>
									<td>
										<select class="form-select form-select-sm">
											<option selected>Stable</option>
											<option>Beta</option>
										</select>
									</td>
									<td class="text-end">
										<div class="btn-group">
											<button class="btn btn-primary btn-sm update-btn" data-package-id="1">
												<i class="bi bi-arrow-up-circle me-1"></i> Update
											</button>
											<button type="button" class="btn btn-primary btn-sm dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
												<span class="visually-hidden">Toggle Dropdown</span>
											</button>
											<ul class="dropdown-menu">
												<li>
													<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#releaseNotesModal">
														<i class="bi bi-card-text me-2"></i>View Release Notes
													</a>
												</li>
												<li>
													<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#packageDetailsModal">
														<i class="bi bi-eye me-2"></i>Details
													</a>
												</li>
												<li>
													<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#rollbackModal">
														<i class="bi bi-arrow-counterclockwise me-2"></i>Rollback
													</a>
												</li>
											</ul>
										</div>
									</td>
								</tr>
								<tr id="package-row-2">
									<td>
										<strong>WP2 Update Plugin</strong>
										<div class="text-muted small">ourfreewp/wp2-update</div>
									</td>
									<td>0.0.30</td>
									<td>
										<span class="badge bg-success-light rounded-pill">
											<i class="bi bi-check-circle-fill me-1"></i>Up to date
										</span>
									</td>
									<td>
										<select class="form-select form-select-sm">
											<option selected>Stable</option>
											<option>Beta</option>
										</select>
									</td>
									<td class="text-end">
										<div class="btn-group">
											<button class="btn btn-outline-secondary btn-sm disabled" disabled>
												Update
											</button>
											<button type="button" class="btn btn-outline-secondary btn-sm dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
												<span class="visually-hidden">Toggle Dropdown</span>
											</button>
											<ul class="dropdown-menu">
												<li>
													<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#packageDetailsModal">
														<i class="bi bi-eye me-2"></i>Details
													</a>
												</li>
												<li>
													<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#rollbackModal">
														<i class="bi bi-arrow-counterclockwise me-2"></i>Rollback
													</a>
												</li>
											</ul>
										</div>
									</td>
								</tr>
								<tr>
									<td>
										<strong>Legacy Widget Pack</strong>
										<div class="text-muted small">client-org/legacy-widgets</div>
									</td>
									<td>2.1.5</td>
									<td>
										<span class="badge bg-secondary-light rounded-pill">
											<i class="bi bi-exclamation-circle-fill me-1"></i>Unmanaged
										</span>
									</td>
									<td>N/A</td>
									<td class="text-end">
										<button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#assignAppModal">
											<i class="bi bi-link-45deg me-1"></i> Assign App
										</button>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<!-- Apps Panel -->
			<div class="tab-pane fade" id="apps-panel" role="tabpanel">
				<div class="card mt-4">
					<div class="card-body">
						<table class="table table-hover">
							<thead>
								<tr>
									<th>App Name</th>
									<th>Account</th>
									<th>Managed Packages</th>
									<th>Status</th>
									<th class="text-end">Actions</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>
										<strong>OTW Production App</strong>
										<div class="text-muted small">on-the-water-media-app</div>
									</td>
									<td>Organization</td>
									<td>2</td>
									<td>
										<span class="badge bg-success-light rounded-pill">
											<i class="bi bi-check-circle-fill me-1"></i>Connected
										</span>
									</td>
									<td class="text-end">
										<button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#appDetailsModal">
											<i class="bi bi-eye me-1"></i> Details
										</button>
									</td>
								</tr>
								<tr>
									<td>
										<strong>Staging Updater</strong>
										<div class="text-muted small">my-staging-updater</div>
									</td>
									<td>Personal</td>
									<td>5</td>
									<td>
										<span class="badge bg-success-light rounded-pill"></span>
											<i class="bi bi-check-circle-fill me-1"></i>Connected
										</span>
									</td>
									<td class="text-end">
										<button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#appDetailsModal">
											<i class="bi bi-eye me-1"></i> Details
										</button>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<!-- Health Panel -->
			<div class="tab-pane fade" id="health-panel" role="tabpanel">
				<div class="row g-4 mt-3">
					<div class="col-lg-6">
						<div class="card h-100 health-card">
							<div class="card-body">
								<h5 class="card-title"><i class="bi bi-pc-display-horizontal me-2"></i>Server Environment</h5>
								<ul class="list-group list-group-flush"></ul>
									<li class="list-group-item d-flex justify-content-between align-items-center">PHP Version 8.3.1 <i class="bi bi-check-circle-fill pass"></i></li>
									<li class="list-group-item d-flex justify-content-between align-items-center">WordPress Version 6.5.2 <i class="bi bi-check-circle-fill pass"></i></li>
									<li class="list-group-item d-flex justify-content-between align-items-center">cURL Extension Loaded <i class="bi bi-check-circle-fill pass"></i></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="col-lg-6">
						<div class="card h-100 health-card">
							<div class="card-body">
								<h5 class="card-title"><i class="bi bi-github me-2"></i>GitHub Connectivity</h5>
								<ul class="list-group list-group-flush">
									<li class="list-group-item d-flex justify-content-between align-items-center">API Connection <i class="bi bi-check-circle-fill pass"></i></li>
									<li class="list-group-item d-flex justify-content-between align-items-center">Webhook Status <span class="text-muted small">2 of 2 apps responding</span> <i class="bi bi-check-circle-fill pass"></i></li>
									<li class="list-group-item d-flex justify-content-between align-items-center">Rate Limit <span class="text-muted small">4987/5000 remaining</span> <i class="bi bi-check-circle-fill pass"></i></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="col-12">
						<div class="card">
							<div class="card-body">
								<h5 class="card-title"><i class="bi bi-terminal me-2"></i>Live Log Stream</h5>
								<div class="log-viewer" id="log-viewer">
									<!-- Log entries will be added here by JS -->
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Modals -->
	<!-- Create Package Modal -->
	<div class="modal fade" id="createPackageModal" tabindex="-1">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<div class="wizard-step active" id="wizard-create-1">
					<div class="modal-header">
						<h5 class="modal-title">Create New Package - Step 1 of 3</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
					</div>
					<div class="modal-body">
						<h6>Choose Package Type</h6>
						<p class="text-muted">Start by creating a new Plugin or Theme from a template.</p>
						<div class="d-grid gap-3">
							<button class="btn btn-outline-primary p-3 text-start wizard-next-btn">
								<i class="bi bi-plugin fs-4 me-3"></i>
								<div><strong class="d-block">Plugin</strong>Create a new WordPress plugin from our starter template.</div>
							</button>
							<button class="btn btn-outline-primary p-3 text-start wizard-next-btn">
								<i class="bi bi-palette fs-4 me-3"></i>
								<div><strong class="d-block">Theme</strong>Create a new WordPress theme from our starter template.</div>
							</button>
						</div>
					</div>
				</div>
				<div class="wizard-step" id="wizard-create-2">
					<div class="modal-header">
						<h5 class="modal-title">Create New Package - Step 2 of 3</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
					</div>
					<div class="modal-body">
						<h6>Configure Your Package</h6>
						<div class="mb-3">
							<label class="form-label">Package Name</label>
							<input type="text" class="form-control" placeholder="e.g., My Awesome Plugin">
						</div>
						<div class="mb-3">
							<label class="form-label">New Repository Name</label>
							<input type="text" class="form-control" placeholder="e.g., my-awesome-plugin">
						</div>
						<div class="mb-3">
							<label class="form-label">Managed By</label>
							<select class="form-select">
								<option>OTW Production App</option>
								<option>Staging Updater</option>
							</select>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-outline-secondary wizard-back-btn">Back</button>
						<button type="button" class="btn btn-primary wizard-next-btn">Create Repository</button>
					</div>
				</div>
				<div class="wizard-step" id="wizard-create-3">
					<div class="modal-header">
						<h5 class="modal-title">Create New Package - Step 3 of 3</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
					</div>
					<div class="modal-body text-center p-5">
						<div class="spinner-border text-primary" role="status">
							<span class="visually-hidden">Loading...</span>
						</div>
						<p class="mt-3 mb-0">Creating repository on GitHub...</p>
						<p class="text-muted small">Installing and linking to app...</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Add App Modal -->
	<div class="modal fade" id="addAppModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Connect a New GitHub App</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<h6>Step 1: Name Your Connection</h6>
					<p class="text-muted">Give your connection a memorable name for this site.</p>
					<input type="text" class="form-control mb-4" placeholder="e.g., My Production Site Updater">
					<h6>Step 2: Create on GitHub</h6>
					<p class="text-muted">Follow the on-screen instructions on GitHub to create and install the secure app on your desired repositories.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="create-app-btn">
						<i class="bi bi-github me-1"></i> Create Secure App on GitHub
					</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Other Modals (Rollback, Assign, Release Notes, Details) -->
	<div class="modal fade" id="rollbackModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Rollback OTW Theme</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p>Select a previous stable version to roll back to.</p>
					<select class="form-select">
						<option>1.0.1</option>
						<option>1.0.0</option>
					</select>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-danger" id="confirm-rollback-btn">Rollback to 1.0.1</button>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="assignAppModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Assign App to "Legacy Widget Pack"</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p>Choose which GitHub App should manage updates for this package.</p>
					<select class="form-select">
						<option>OTW Production App</option>
						<option>Staging Updater</option>
					</select>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="confirm-assign-btn">Assign App</button>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="releaseNotesModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Release Notes for OTW Theme v1.1.0</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<h3>New Features ✨</h3>
					<ul>
						<li>Added a new "Hero" block for the block editor.</li>
						<li>Integrated with the latest version of the Cool Framework.</li>
					</ul>
					<h3>Bug Fixes 🐛</h3>
					<ul>
						<li>Fixed a CSS issue on mobile devices.</li>
						<li>Improved accessibility for screen readers.</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="packageDetailsModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Package Details: OTW Theme</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<h6><i class="bi bi-info-circle me-2"></i>Information</h6>
					<p class="text-muted small">Managed By: OTW Production App<br>Last Synced: 2 minutes ago</p>
					<h6><i class="bi bi-clock-history me-2"></i>Sync History</h6>
					<div class="log-viewer" style="height: 150px;">
						<div>[2025-10-12 17:59:07] [INFO] Sync complete. 1 update found.</div>
						<div>[2025-10-12 11:55:21] [INFO] Webhook received. Clearing transients.</div>
						<div>[2025-10-12 10:01:45] [INFO] Sync initiated by user.</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="appDetailsModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">App Details: OTW Production App</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6">
							<h6><i class="bi bi-key me-2"></i>Credentials</h6>
							<p class="text-muted small">App ID: 12345<br>Installation ID: 67890</p>
						</div>
						<div class="col-md-6">
							<h6><i class="bi bi-hdd-stack me-2"></i>Repositories (2)</h6>
							<ul class="list-unstyled">
								<li><small>On-The-Water-Media/otw-theme</small></li>
								<li><small>On-The-Water-Media/otw-core-plugin</small></li>
							</ul>
						</div>
					</div>
				</div>
				<div class="modal-footer justify-content-between">
					<button type="button" class="btn btn-danger" id="disconnect-app-btn">Disconnect App</button>
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Toast Container -->
	<div class="toast-container position-fixed bottom-0 end-0 p-3">
		<div id="action-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
			<div class="toast-header">
				<strong class="me-auto">WP2 Update</strong>
				<button type="button" class="btn-close" data-bs-dismiss="toast"></button>
			</div>
			<div class="toast-body">This is a toast message.</div>
		</div>
	</div>
	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const toastEl = document.getElementById('action-toast');
			const toast = new bootstrap.Toast(toastEl);

			function showToast(message, type = 'success') {
				const toastBody = toastEl.querySelector('.toast-body');
				toastBody.textContent = message;
				toastEl.classList.remove('bg-success', 'bg-danger', 'bg-warning', 'text-white');
				toastEl.classList.add(`bg-${type === 'error' ? 'danger' : type}`, 'text-white');
				toast.show();
			}

			// --- Live Log Simulation ---
			const logViewer = document.getElementById('log-viewer');
			const logLevels = ['INFO', 'DEBUG', 'WARNING', 'ERROR', 'SECURITY'];
			const logMessages = [
				'Sync initiated by user.',
				'Fetching releases for On-The-Water-Media/otw-theme...',
				'Found new release: 1.1.0',
				'Sync complete. 1 update found.',
				'Webhook event received: release',
				'Webhook signature validated successfully.',
				'Cleared update transients.',
				'API rate limit check: 4987 remaining.',
				'User authentication successful for admin.',
				'Checking database schema for wp2_update_logs.',
				'Database schema is up to date.'
			];

			function addLogEntry() {
				if (logViewer.children.length > 100) {
					logViewer.removeChild(logViewer.firstChild);
				}
				const level = logLevels[Math.floor(Math.random() * logLevels.length)];
				const message = logMessages[Math.floor(Math.random() * logMessages.length)];
				const timestamp = new Date().toISOString().replace('T', ' ').substring(0, 19);

				const entry = document.createElement('div');
				entry.className = 'log-entry';
				entry.innerHTML = `<span class="timestamp">[${timestamp}]</span> <span class="level-${level}">[${level}]</span> ${message}`;
				logViewer.appendChild(entry);
				logViewer.scrollTop = logViewer.scrollHeight;
			}

			// Start adding logs when the health tab is shown
			const healthTab = document.getElementById('health-tab');
			let logInterval;
			healthTab.addEventListener('shown.bs.tab', () => {
				if (!logInterval) {
					addLogEntry(); // Add one immediately
					logInterval = setInterval(addLogEntry, Math.random() * 3000 + 1000);
				}
			});
			document.querySelector('[data-bs-target="#packages-panel"]').addEventListener('shown.bs.tab', () => clearInterval(logInterval));
			document.querySelector('[data-bs-target="#apps-panel"]').addEventListener('shown.bs.tab', () => clearInterval(logInterval));

			// --- Wizard Logic ---
			function setupWizard(modalId) {
				const wizardModalEl = document.getElementById(modalId);
				const wizardSteps = wizardModalEl.querySelectorAll('.wizard-step');

				wizardModalEl.addEventListener('click', function (e) {
					if (e.target.classList.contains('wizard-next-btn')) {
						const currentStep = e.target.closest('.wizard-step');
						const nextStep = currentStep.nextElementSibling;
						if (nextStep && nextStep.classList.contains('wizard-step')) {
							currentStep.classList.remove('active');
							nextStep.classList.add('active');
							if (nextStep.id === 'wizard-create-3') {
								// Fake the creation process
								setTimeout(() => {
									const modal = bootstrap.Modal.getInstance(wizardModalEl);
									modal.hide();
									showToast('New package created successfully!');
									// Reset wizard for next time
									wizardSteps.forEach(s => s.classList.remove('active'));
									wizardSteps[0].classList.add('active');
								}, 3000);
							}
						}
					} else if (e.target.classList.contains('wizard-back-btn')) {
						const currentStep = e.target.closest('.wizard-step');
						const prevStep = currentStep.previousElementSibling;
						if (prevStep && prevStep.classList.contains('wizard-step')) {
							currentStep.classList.remove('active');
							prevStep.classList.add('active');
						}
					}
				});
			}
			setupWizard('createPackageModal');

			// --- Fake Interactions ---
			document.getElementById('sync-all-btn').addEventListener('click', function () {
				const btn = this;
				const originalText = btn.innerHTML;
				btn.innerHTML = `<span class="spinner-border spinner-border-sm"></span> Syncing...`;
				btn.disabled = true;
				addLogEntry(); // Simulate a log entry on sync

				setTimeout(() => {
					btn.innerHTML = originalText;
					btn.disabled = false;
					showToast('All packages synced successfully.');
				}, 2000);
			});

			document.querySelectorAll('.update-btn').forEach(button => {
				button.addEventListener('click', function () {
					const packageId = this.getAttribute('data-package-id');
					const row = document.getElementById(`package-row-${packageId}`);

					this.innerHTML = `<span class="spinner-border spinner-border-sm"></span> Updating...`;
					this.disabled = true;
					row.classList.add('updating-row');

					setTimeout(() => {
						row.classList.remove('updating-row');
						const statusCell = row.querySelector('td:nth-child(3)');
						const versionCell = row.querySelector('td:nth-child(2)');
						statusCell.innerHTML = `<span class="badge bg-success-light rounded-pill"><i class="bi bi-check-circle-fill me-1"></i>Up to date</span>`;
						versionCell.textContent = '1.1.0';
						this.closest('.btn-group').innerHTML = `<button class="btn btn-outline-secondary btn-sm disabled" disabled>Update</button><button type="button" class="btn btn-outline-secondary btn-sm dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false"><span class="visually-hidden">Toggle Dropdown</span></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#packageDetailsModal"><i class="bi bi-eye me-2"></i>Details</a></li><li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#rollbackModal"><i class="bi bi-arrow-counterclockwise me-2"></i>Rollback</a></li></ul>`;
						showToast('OTW Theme updated to 1.1.0 successfully!');
					}, 2500);
				});
			});

			// Generic modal interaction handlers
			const handleModalAction = (buttonId, modalId, message, messageType = 'success') => {
				document.getElementById(buttonId)?.addEventListener('click', function () {
					showToast(message, messageType);
					const modalEl = document.getElementById(modalId);
					if (modalEl) {
						const modal = bootstrap.Modal.getInstance(modalEl);
						if (modal) modal.hide();
					}
				});
			};

			handleModalAction('create-app-btn', 'addAppModal', 'Redirecting to GitHub to create app...');
			handleModalAction('confirm-rollback-btn', 'rollbackModal', 'Rollback initiated...');
			handleModalAction('confirm-assign-btn', 'assignAppModal', 'Package assigned successfully.');
			handleModalAction('disconnect-app-btn', 'appDetailsModal', 'App disconnected.', 'error');
		});
	</script>
</body>
</html>
